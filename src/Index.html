<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Green Computing</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <header>
        <div class="container-fluid p-0">
            <!--Navbar-->
            <nav class="navbar navbar-expand-sm bg-dark navbar-dark">
                <div class="container">
                    <a href="#" class="navbar-brand"> Green Computing</a>
                    <button 
                        class="navbar-toggler" 
                        type="button" 
                        data-bs-toggle="collapse" 
                        data-bs-target="#navmenu">
                        <span class="navbar-toggler-icon"></span>
                    </button>
<!--
                    <div class="collapse navbar-collapse" id="navmenu">
                        <ul class="navbar-nav ms-auto">
                            <li class="nav-item">
                                <a href="#Data" class="nav-link">Data</a>
                            </li>
                            <li class="nav-item">
                                <a href="#Calculate" class="nav-link">Calculation</a>
                            </li>
                            <li class="nav-item">
                                <a href="#Result" class="nav-link">Result</a>
                            </li>
                        </ul>
                    </div>
 -->                
                </div>
            </nav>
        </div>

    </header>
    <main>
        <div class="container">
            <br/>
<!--
            
-->         
<div class="input-group mb-3">
                <input type="file" class="form-control" id="csvFileInput">
            </div>
            <table class="table table-striped" id="csvRoot"></table>
            <!--State Block-->
            <div class="mb-3">
                <label for="state" class="form-label"><h5>Step 1.</h5></label>
                <div class="row g-2">
                    <div class="col-md-5 col-sm-12">
                            <select id="state" class="form-select" aria-label="Default select example">
                                <option selected>Choose a state</option>
                                <option value="04">AZ</option>
                                <option value="06">CA</option>
                                <option value="3">OH</option>
                            </select>
                        </form>
                    </div>
                    <div class="col-md-7 col-sm-12"></div>
                </div>
            </div>
            <hr/>

            <!--range block-->
            <div class="mb-3">
                    <label for="customRange1" class="form-label">Percentage</label>
                    <input type="range" class="form-range" id="customRange1">
                </div>
                <button onclick="calculateReuslt()" class="btn btn-primary" >Calculate</button>
            <div class="row d-none" id="result">
                <div class="col-md-6 col-sm-12" id="resultCost" >
                    <ul class="list-group">
                        <li class="list-group-item">
                            <div class="ms-2 me-auto">
                                <div class="fw-bold">Total Cost</div>
                                <p id="totalCost">10%</p>
                            </div>
                        </li>
                        <li class="list-group-item">
                            <div class="ms-2 me-auto">
                                <div class="fw-bold">Traditional Energy Percentage</div>
                                <p id="TEP">10%</p>
                            </div>
                        </li>
                        <li class="list-group-item">
                            <div class="ms-2 me-auto">
                                <div class="fw-bold">Traditional Energy Cost</div>
                                <p id="TEC">100000</p> 
                            </div>
                        </li>
                        <li class="list-group-item">
                            <div class="ms-2 me-auto">
                                <div class="fw-bold">Green Energy Percentage</div>
                                <p id="GEP">100000</p> 
                            </div>
                        </li>
                        <li class="list-group-item">
                            <div class="ms-2 me-auto">
                                <div class="fw-bold">Green Energy Cost</div>
                                <p id="GEC">100000</p> 
                            </div>
                        </li>
                        <li class="list-group-item">
                            <div class="ms-2 me-auto">
                                <div class="fw-bold">Fine</div>
                                <p id="fineNum">100000</p> 
                            </div>
                        </li>
                        <li class="list-group-item">
                            <div class="ms-2 me-auto">
                                <div class="fw-bold">Subsidies</div>
                                <p id="subsidiesNum">100000</p> 
                            </div>
                        </li>
                    </ul>
                </div>
                <div class="col-md-6 col-sm-12">
                    <div class="container">
                        <canvas id="myChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
    </main>
    <footer>

    </footer>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.6.0/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <script src="../lib/papaparse.min.js"></script>
    <script type="text/javascript" src="../js/chart.js"></script>
    <script type="text/javascript" src="../js/state.js"></script>
    <script type="module" src="../js/main.js"></script>
    <script>
        

        let totalCost = document.querySelector("#totalCost");
        let tep = document.querySelector("#TEP");
        let tec = document.querySelector("#TEC");
        let gep = document.querySelector("#GEP");
        let gec = document.querySelector("#GEC");
        let fineN = document.querySelector("#fineNum");
        let subsidiesN = document.querySelector("#subsidiesNum");
        let result = document.querySelector("#result");

        function calculateReuslt() {
            const state = document.querySelector('#state');

            console.log("start to calculate result!");

            //from page
            let choosenState = state.value;
            let percentageTE = Number(document.querySelector("input[type='range']").value);
            let percentageGE = 100-percentageTE;
            console.log("state:" + state.value+", percentageTE:"+percentageTE+", percentageGE:"+percentageGE);

            //from table
            let rowState = document.querySelector("#state-"+choosenState);
            let stateName = rowState.children[1].textContent;
            let teNum = Number(rowState.children[2].textContent);
            let geNum = Number(rowState.children[3].textContent);
            let fine = Number(rowState.children[4].textContent);
            let	subsidies = Number(rowState.children[5].textContent);
            console.log("stateName:" + stateName+", teNum:"+teNum+", geNum:"+geNum+", fine:"+fine+", subsidies:"+subsidies);

            //result
            let cost = teNum*percentageTE/100+geNum*percentageGE/100+fine*teNum-subsidies*geNum;
            console.log(cost);


            //show
            tep.textContent = percentageTE+"%";
            tec.textContent = teNum*percentageTE;
            gep.textContent = percentageGE+"%";
            gec.textContent = geNum*percentageGE;
            fineN.textContent = fine*teNum;
            subsidiesN.textContent = subsidies*geNum;
            totalCost.textContent = cost;

            //show in pie
            myChart.data.datasets[0].data = [percentageTE,percentageGE];
            myChart.update();
            
            result.classList.remove("d-none");
        }
    </script>
</body>
</html>